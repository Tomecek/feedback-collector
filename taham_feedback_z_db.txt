from sentence_transformers import SentenceTransformer
from sklearn.cluster import KMeans
import pandas as pd

# NaÄti data (nebo nahraÄ vlastnÃ­m CSV)
queries = [
    "Jak si zmÄ›nÃ­m heslo?",
    "Kdy mÃ¡m dalÅ¡Ã­ smÄ›nu?",
    "Jak se pÅ™ihlÃ¡sÃ­m do systÃ©mu?",
    "Kde najdu vÃ½platnÃ­ pÃ¡sku?",
    "Mohu si vzÃ­t dovolenou v Äervenci?",
    "Jak nahlÃ¡sÃ­m nemoc?",
    "Kdy bude vÃ½plata?",
    "Jak kontaktuji IT podporu?",
    "MÃ¡m problÃ©m s pÅ™ihlÃ¡Å¡enÃ­m",
    "PotÅ™ebuji zmÄ›nit bankovnÃ­ ÃºÄet",
    "Co mÃ¡m dÄ›lat, kdyÅ¾ zapomenu heslo?",
    "Jak funguje benefitnÃ­ program?",
    "Kolik dnÃ­ dovolenÃ© mi zbÃ½vÃ¡?",
    "Jak mohu poÅ¾Ã¡dat o home office?",
    "Kde najdu manuÃ¡l k systÃ©mu?"
]

# NaÄtenÃ­ pÅ™edtrÃ©novanÃ©ho modelu pro ÄeÅ¡tinu
model = SentenceTransformer("sentence-transformers/distiluse-base-multilingual-cased")
embeddings = model.encode(queries)

# KMeans klastrovÃ¡nÃ­
kmeans = KMeans(n_clusters=5, random_state=42)
labels = kmeans.fit_predict(embeddings)

# VÃ½pis vÃ½sledkÅ¯
df = pd.DataFrame({"query": queries, "cluster": labels})
for cluster_id in sorted(df["cluster"].unique()):
    print(f"\nğŸŸ© Cluster {cluster_id}:")
    print(df[df["cluster"] == cluster_id]["query"].to_string(index=False))
    


"""from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.cluster import AgglomerativeClustering

# TF-IDF
vectorizer = TfidfVectorizer()
X = vectorizer.fit_transform(queries)

# HierarchickÃ© klastrovÃ¡nÃ­ (bez pÅ™edpokladu sfÃ©rickÃ½ch clusterÅ¯)
agglo = AgglomerativeClustering(n_clusters=7)
labels = agglo.fit_predict(X.toarray())

# VÃ½pis vÃ½sledkÅ¯
df = pd.DataFrame({"query": queries, "cluster": labels})
for cluster_id in sorted(df["cluster"].unique()):
    print(f"\nğŸ”· Cluster {cluster_id}:")
    print(df[df["cluster"] == cluster_id]["query"].to_string(index=False))
"""